Correctness Tests: 
Testing with b=6, h=24, n=2048, d=128
Traceback (most recent call last):
  File "/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd_check.py", line 117, in <module>
    check_correctness(b, h, n, d)
  File "/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd_check.py", line 91, in check_correctness
    avg_diff_mag = torch.mean(torch.abs(diff)).item()
                              ^^^^^^^^^^^^^^^
RuntimeError: CUDA error: unspecified launch failure
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

========= COMPUTE-SANITIZER
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (6,7,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (7,7,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (0,8,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (3,1,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (11,8,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (12,8,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (2,3,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (3,3,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (2,4,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (3,4,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (2,5,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (3,5,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (6,11,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (3,6,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (6,0,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (9,7,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (4,1,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (5,1,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (4,2,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (5,2,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (4,3,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (5,3,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (3,10,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (4,10,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (14,10,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (15,10,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (4,6,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (5,6,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (8,0,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (9,0,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (6,1,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (5,8,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (6,2,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (7,2,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (6,3,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (11,9,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (5,10,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (7,4,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (0,11,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (7,5,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (6,6,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (7,6,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (12,7,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (11,0,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (8,1,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (9,1,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (8,2,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (9,2,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (12,9,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (9,3,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (8,4,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (9,4,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (1,11,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (9,5,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (8,6,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (9,6,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (13,7,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (13,0,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (10,1,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (11,1,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (2,9,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (11,2,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (10,3,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (11,3,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (10,4,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (11,4,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (2,11,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (11,5,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (10,6,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (11,6,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (14,0,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (15,0,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (12,1,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (13,1,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (3,9,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (13,2,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (14,9,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (13,3,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (9,10,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (13,4,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (3,11,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (13,5,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (12,6,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (13,6,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (0,1,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (1,1,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (14,1,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (15,1,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (14,2,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (15,2,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (15,9,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (15,3,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (10,10,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (15,4,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (14,5,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (15,5,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (14,11,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (15,6,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (0,2,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
========= Illegal barrier arrive operation
=========     at 0x1cc0 in /home/lidong1/yuqxia/ThunderKittens/src/ops/warp/memory/util/tma.cuh:53:kittens::tma::set_bytes(unsigned long &, unsigned int)
=========     by thread (0,0,0) in block (1,2,0)
=========     Device Frame:/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd.cu:146:void fwd_attend_ker_dim<(int)128>(int, int, const CUtensorMap_st *, const CUtensorMap_st *, const CUtensorMap_st *, __nv_bfloat16 *, __nv_bfloat16 *, CUtensorMap_st *) [0x1b90]
=========     Saved host backtrace up to driver entry point at kernel launch time
=========     Host Frame: [0x3344e0]
=========                in /lib/x86_64-linux-gnu/libcuda.so.1
=========     Host Frame: [0x1498c]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:cudaLaunchKernel [0x6bedb]
=========                in /home/lidong1/miniconda3/envs/kernel/lib/python3.12/site-packages/torch/lib/../../../../libcudart.so.12
=========     Host Frame:attention_forward_causal(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor) [0x9830]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::initialize<void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, pybind11::name, pybind11::scope, pybind11::sibling>(void (*&)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), void (*)(at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor, at::Tensor), pybind11::name const&, pybind11::scope const&, pybind11::sibling const&)::{lambda(pybind11::detail::function_call&)#3}::_FUN(pybind11::detail::function_call&) [0xd2d4]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:pybind11::cpp_function::dispatcher(_object*, _object*, _object*) [0x166f7]
=========                in /home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/build/lib.linux-x86_64-cpython-312/h100_fwd.cpython-312-x86_64-linux-gnu.so
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/methodobject.c:550:cfunction_call [0x152b44]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Objects/call.c:242:_PyObject_MakeTpCall [0x120d4b]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:Python/bytecodes.c:2710:_PyEval_EvalFrameDefault [0x12d15c]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/ceval.c:579:PyEval_EvalCode [0x1f8a2e]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1723:run_eval_code_obj [0x21d897]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1744:run_mod [0x2191a7]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:1643:pyrun_file [0x22ecf2]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:433:_PyRun_SimpleFileObject [0x22e630]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Python/pythonrun.c:78:_PyRun_AnyFileObject [0x22e423]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:709:Py_RunMain [0x2285f3]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame:/usr/local/src/conda/python-3.12.2/Modules/main.c:764:Py_BytesMain [0x1e4099]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
=========     Host Frame: [0x29d90]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame:__libc_start_main [0x29e40]
=========                in /lib/x86_64-linux-gnu/libc.so.6
=========     Host Frame: [0x1e3ece]
=========                in /home/lidong1/miniconda3/envs/kernel/bin/python
========= 
Correctness Tests: 
Testing with b=6, h=2, n=2048, d=128
Traceback (most recent call last):
  File "/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd_check.py", line 118, in <module>
    check_correctness(b, h, n, d)
  File "/home/lidong1/yuqxia/ThunderKittens/examples/sm_attn_causal/h100_fwd_check.py", line 92, in check_correctness
    avg_diff_mag = torch.mean(torch.abs(diff)).item()
                              ^^^^^^^^^^^^^^^
RuntimeError: CUDA error: unspecified launch failure
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

========= Target application returned an error
========= ERROR SUMMARY: 116 errors
========= ERROR SUMMARY: 16 errors were not printed. Use --print-limit option to adjust the number of printed errors
